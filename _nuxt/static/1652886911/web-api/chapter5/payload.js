__NUXT_JSONP__("/web-api/chapter5", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){return {data:[{document:{slug:"chapter5",description:m,title:m,position:205,category:"Web API的設計與開發",menuTitle:"Chapter 05",contributors:["cshs108"],toc:[],body:{type:"root",children:[{type:c,tag:e,props:{},children:[{type:a,value:"5.1 方便更改設計的重要性"}]},{type:a,value:b},{type:c,tag:f,props:{},children:[{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"API必須保持公開提供串接的狀態，但是我們會需要添加新功能、廢棄某些功能"}]},{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"如果只是修改API內部邏輯，對外的數據格式不變，則不需要更新API設計規範"}]},{type:a,value:b}]},{type:a,value:b},{type:c,tag:e,props:{},children:[{type:a,value:"5.1.1 公開發佈的API"}]},{type:a,value:b},{type:c,tag:f,props:{},children:[{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"LSUD(Large set of unknown developers)\n"},{type:c,tag:f,props:{},children:[{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"ex.FB這類的公開API"}]},{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"影響不特定開發者，範圍未知"}]},{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"API改版的影響程度大"}]},{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"無法保證用戶端可以搭配API改版而重新串接，此時強制變更API會導致終端用戶、串接應用，覺得這個服務不可靠"}]},{type:a,value:b}]},{type:a,value:b}]},{type:a,value:b}]},{type:a,value:b},{type:c,tag:e,props:{},children:[{type:a,value:"5.1.2 面向移動應用的API"}]},{type:a,value:b},{type:c,tag:f,props:{},children:[{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"SSKD(Small set of known develop)\n"},{type:c,tag:f,props:{},children:[{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"只有影響特定開發者，範圍可控"}]},{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"API的改版影響程度小"}]},{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"注意不更新應用程式的刁民"}]},{type:a,value:b}]},{type:a,value:b}]},{type:a,value:b}]},{type:a,value:b},{type:c,tag:e,props:{},children:[{type:a,value:"5.1.3 Web服務中使用的API"}]},{type:a,value:b},{type:c,tag:f,props:{},children:[{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"注意快取的影響"}]},{type:a,value:b}]},{type:a,value:b},{type:c,tag:e,props:{},children:[{type:a,value:"5.2 透過版本訊息來管理API"}]},{type:a,value:b},{type:c,tag:f,props:{},children:[{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:b},{type:c,tag:e,props:{},children:[{type:a,value:"更新API有會不等程度的影響，透過某些機制讓不更新用戶可以繼續使用舊的服務，更新後的用戶使用新的服務"}]},{type:a,value:b},{type:c,tag:e,props:{},children:[{type:c,tag:l,props:{alt:"截圖 2022-01-12 下午11.43.43.png",src:"https:\u002F\u002Fspiny-backbone-80c.notion.site\u002Fimage\u002Fhttps%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F29bf5df3-10d1-4a7b-bc29-a5d707f00340%2F%E6%88%AA%E5%9C%96_2022-01-12_%E4%B8%8B%E5%8D%8811.43.43.png?table=block&id=0e1b970a-4780-46ec-98d9-fb6c780f5c3c&spaceId=5d2d13ed-dba9-47b9-be73-4ea525461379&width=2000&userId=&cache=v2"},children:[]}]},{type:a,value:b}]},{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:b},{type:c,tag:e,props:{},children:[{type:a,value:"實現的方式"}]},{type:a,value:b},{type:c,tag:f,props:{},children:[{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"不同的URI\n"},{type:c,tag:f,props:{},children:[{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"舊的："},{type:c,tag:g,props:{href:n,rel:[h,i,j],target:k},children:[{type:a,value:n}]}]},{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"新的："},{type:c,tag:g,props:{href:o,rel:[h,i,j],target:k},children:[{type:a,value:o}]}]},{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"議題：new的命名不好，如果之後又要改版，newnewapi?"}]},{type:a,value:b}]},{type:a,value:b}]},{type:a,value:b}]},{type:a,value:b}]},{type:a,value:b}]},{type:a,value:b},{type:c,tag:e,props:{},children:[{type:a,value:"5.2.1 在URI中嵌入版本編號"}]},{type:a,value:b},{type:c,tag:f,props:{},children:[{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:b},{type:c,tag:e,props:{},children:[{type:c,tag:g,props:{href:p,rel:[h,i,j],target:k},children:[{type:a,value:p}]}]},{type:a,value:b}]},{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:b},{type:c,tag:e,props:{},children:[{type:a,value:"最常見的方式，舊版本的api短時間能可繼續使用"}]},{type:a,value:b},{type:c,tag:e,props:{},children:[{type:c,tag:l,props:{alt:"截圖 2022-01-12 下午11.50.22.png",src:"https:\u002F\u002Fspiny-backbone-80c.notion.site\u002Fimage\u002Fhttps%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F3225328c-044c-4b7e-9235-90d4cb26339f%2F%E6%88%AA%E5%9C%96_2022-01-12_%E4%B8%8B%E5%8D%8811.50.22.png?table=block&id=682fa534-6843-4827-afbb-4b85f5857ee3&spaceId=5d2d13ed-dba9-47b9-be73-4ea525461379&width=2000&userId=&cache=v2"},children:[]}]},{type:a,value:b}]},{type:a,value:b}]},{type:a,value:b},{type:c,tag:e,props:{},children:[{type:a,value:"5.2.2 如何添加版本編號"}]},{type:a,value:b},{type:c,tag:f,props:{},children:[{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"編號規則：主版本編號、次版本編號、補丁版本編號。ex.1.0.1"}]},{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"如果只是修正BUG，則增加補丁版本編號ex.1.0.2"}]},{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"如果功能新、刪，且向下兼容，則增加次版本編號ex.1.1.1"}]},{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"如果本次修改無法向下兼容，則增加主版本編號ex.2.0.1"}]},{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"以"},{type:c,tag:g,props:{href:"http:\u002F\u002Fapi.example.com\u002Fv1\u002Fuser\u002F123%E4%BE%86%E8%AA%AA%EF%BC%8C%E5%8F%AA%E4%BD%BF%E7%94%A8%E4%B8%80%E5%80%8B%E7%89%88%E6%9C%AC%E7%B7%A8%E8%99%9F%EF%BC%8C%E4%BB%A3%E8%A1%A8%E7%82%BA%E4%B8%BB%E7%89%88%E6%9C%AC%E7%B7%A8%E8%99%9F%EF%BC%8C%E5%9B%A0%E6%AD%A4%E7%95%B6%E4%B8%BB%E7%89%88%E6%9C%AC%E7%B7%A8%E8%99%9F%E5%A2%9E%E5%8A%A0%E6%99%82%EF%BC%8CAPI%E6%89%8D%E9%80%B2%E8%A1%8C%E7%89%88%E6%9C%AC%E5%8D%87%E7%B4%9A",rel:[h,i,j],target:k},children:[{type:a,value:"http:\u002F\u002Fapi.example.com\u002Fv1\u002Fuser\u002F123來說，只使用一個版本編號，代表為主版本編號，因此當主版本編號增加時，API才進行版本升級"}]}]},{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"同時維護多版本的API成本相當高，也容易讓用戶混淆該用哪一個，因此小更動會盡量不去升級api版本，而是盡可能地向下相容"}]},{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"只有發生可以放棄下向相容的重大更新時才去升級api版本，因此大部分的api的網址版本編號只有主版本編號ex.\u002Fv1"}]},{type:a,value:b}]},{type:a,value:b},{type:c,tag:e,props:{},children:[{type:a,value:"5.2.3 在查詢字串加入版本訊息"}]},{type:a,value:b},{type:c,tag:f,props:{},children:[{type:a,value:b},{type:c,tag:d,props:{},children:[{type:c,tag:g,props:{href:q,rel:[h,i,j],target:k},children:[{type:a,value:q}]}]},{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"差異：使用參數的方式代表是可以省略，如果沒有填，伺服器會直接使用默認的版本(通常是最新版本)"}]},{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"該選擇加在網址路徑還是參數？\n"},{type:c,tag:f,props:{},children:[{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"建議加在網址路徑，因為參數的方式如果省略的話，用戶其實不知道呼叫到的是哪個版本"}]},{type:a,value:b}]},{type:a,value:b}]},{type:a,value:b}]},{type:a,value:b},{type:c,tag:e,props:{},children:[{type:a,value:"5.2.4 透過媒體類型來指定版本訊息"}]},{type:a,value:b},{type:c,tag:f,props:{},children:[{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"在header加入Accept:application\u002Fapi.example.v2+json"}]},{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"好處：URL可以作為純粹的資源使用"}]},{type:a,value:b}]},{type:a,value:b},{type:c,tag:e,props:{},children:[{type:a,value:"5.2.5 該採用什麼方法"}]},{type:a,value:b},{type:c,tag:f,props:{},children:[{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"最常用的是在URL的路徑中嵌入版本訊息"}]},{type:a,value:b}]},{type:a,value:b},{type:c,tag:e,props:{},children:[{type:a,value:"5.3 版本變更的方針"}]},{type:a,value:b},{type:c,tag:f,props:{},children:[{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"盡可能向下相容"}]},{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"ex.原本使用gender(Int)1=男生2=女生，如果想要改為gender(String)男生、女生的方式紀錄，則建議多一個參數genderStr(String)，並把gender標示為廢棄"}]},{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"什麼時候該升級版本\n"},{type:c,tag:f,props:{},children:[{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"權限、驗證機制調整，ex.v1沒有身份驗證機制，v2有身份驗證機制，則可以廢棄v1升級到v2"}]},{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"因為這類的調整會動到的地方太多，難達成向下相容，因此該升級版本"}]},{type:a,value:b}]},{type:a,value:b}]},{type:a,value:b}]},{type:a,value:b},{type:c,tag:e,props:{},children:[{type:a,value:"5.4 終止提供API"}]},{type:a,value:b},{type:c,tag:f,props:{},children:[{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"公告讓用戶知道該升級，舊API什麼時候結束服務，用戶可以規劃系統升級的時程"}]},{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"Blackout Test：暫時一段時間不提供服務，逼迫用戶提早升級"}]},{type:a,value:b}]},{type:a,value:b},{type:c,tag:e,props:{},children:[{type:a,value:"5.4.2 正式停止舊API"}]},{type:a,value:b},{type:c,tag:f,props:{},children:[{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"回傳http status 410，同時給予錯誤訊息"}]},{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"應用服務必須針對410的錯誤提示用戶該升級系統"}]},{type:a,value:b}]},{type:a,value:b},{type:c,tag:e,props:{},children:[{type:a,value:"5.4.3 在使用條款中寫明支援期限"}]},{type:a,value:b},{type:c,tag:f,props:{},children:[{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"在X個月後，不再支援舊版api，但不是直接關閉服務"}]},{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"新的API出來的時候，同時宣布至少支援X月"}]},{type:a,value:b}]},{type:a,value:b},{type:c,tag:e,props:{},children:[{type:a,value:"5.5 編排層(中間層)"}]},{type:a,value:b},{type:c,tag:f,props:{},children:[{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"ex.fb graph api，源頭端的API可以負責叫小範圍，就像是單一個積木，減少開發的複雜性"}]},{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"終端透過中間層去組裝多個積木來達成頁面的需求"}]},{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"終端可以受到API改版的影響較小，源頭端可以減少API變更的阻礙"}]},{type:a,value:b}]},{type:a,value:b},{type:c,tag:e,props:{},children:[{type:c,tag:l,props:{alt:"截圖 2022-01-13 上午12.30.21.png",src:"https:\u002F\u002Fspiny-backbone-80c.notion.site\u002Fimage\u002Fhttps%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F6006189a-1eb8-427c-95bf-9ecc11863135%2F%E6%88%AA%E5%9C%96_2022-01-13_%E4%B8%8A%E5%8D%8812.30.21.png?table=block&id=ea41ce46-1dba-4281-9890-96fb05b6c6e1&spaceId=5d2d13ed-dba9-47b9-be73-4ea525461379&width=2000&userId=&cache=v2"},children:[]}]},{type:a,value:b},{type:c,tag:e,props:{},children:[{type:a,value:"5.6小結"}]},{type:a,value:b},{type:c,tag:f,props:{},children:[{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"最大限度減少API版本更新的頻率，注意向下兼容"}]},{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"在URI中嵌入API版本的主版本編號"}]},{type:a,value:b},{type:c,tag:d,props:{},children:[{type:a,value:"停止提供API服務時不能立即中止，至少需要繼續公開六個月"}]},{type:a,value:b}]}]},dir:"\u002Fzh\u002Fweb-api",path:"\u002Fzh\u002Fweb-api\u002Fchapter5",extension:".md",createdAt:r,updatedAt:r,readingStats:{text:"7 min read",minutes:6.035,time:362100,words:1207},to:"\u002Fweb-api\u002Fchapter5"},prev:{title:"第2章 EndPoint設計與請求形式",path:"\u002Fzh\u002Fweb-api\u002Fchapter2",to:"\u002Fweb-api\u002Fchapter2"},next:{title:"第6章開發牢固的WebAPI",path:"\u002Fzh\u002Fweb-api\u002Fchapter6",to:"\u002Fweb-api\u002Fchapter6"}}],fetch:{},mutations:[]}}("text","\n","element","li","p","ul","a","nofollow","noopener","noreferrer","_blank","img","第5章 開發方便更改設計的API","http:\u002F\u002Fapi.example.com\u002Fuser\u002F123","http:\u002F\u002Fnewapi.example.com\u002Fuser\u002F123","http:\u002F\u002Fapi.example.com\u002Fv2\u002Fuser\u002F123","http:\u002F\u002Fapi.example.com\u002Fuser\u002F123?v=1.5","2022-05-18T15:14:10.595Z")));